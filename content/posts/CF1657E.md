---
title: "CF1657E"
date: 2022-04-05T21:00:44+08:00
draft: true
---

## 题意

对于一个n个点的无向完全图，边权是1到k的整数。

如果这个完全图的最小生成树大小等于所有与1号点连接的边的边权和，那么称这样一个图是*好的*。

求对于给定的n和k，有多少个图是*好的*。



## tag

dp，组合数学



## solution

首先这是一个完全图，那么所有与1号点连接的边就已经构成一颗生成树，并且这还是一颗最小生成树。

其他的生成树就相当于去掉一条（1，i），连接一条（i，j）。

那么思考一下什么样的图是好的，即在什么时候，边的变化不会影响最小生成树：

得到结论，对于1，i，j这三个点，如果（i，j）>= max{（1，i），（1，j）}，则可以保证最小生成树要么是由与1放射状连接的那些边组成，要么是这个三角形中用（i，j）替换了另两条边之一，同时MST的大小不变。

所以要统计的就是，对于所有（1，i）赋值后，（i，j）们满足条件的赋值方案数的总和。

* 这个用dp来求：

    $dp[i][j]$表示已经赋值的i个边中最长为j的最终方案数。

    接下来枚举赋值边长j+1的边的个数t，即从n-i个边中选出t个，这t个两两之间以及和前i个之间都需要计算边长方案。

```c++
n--;
dp[0][1] = 1;
for (int i=0;i<=n;++i) 
	for (int t=0;i+t<=n;++t)
		for (int j=1;j<=k;++j)  {
			dp[i+t][j+1] = (dp[i+t][j+1] + 
                      dp[i][j]*c[n-i][t]%mod*fp(k-j+1,t*(t-1)/2+i*t)%mod)%mod;
		}
printf("%lld\n",dp[n][k+1]);
```





